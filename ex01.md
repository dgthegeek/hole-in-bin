## Ex01: Command-Line Argument Overflow

### Analyse du binaire

Le programme prend un argument en ligne de commande et vérifie s'il peut modifier une variable spécifique à une valeur donnée.

### Vulnérabilité

Utilisation de `strcpy()` sans vérification de la longueur de l'entrée, permettant un débordement de tampon.

### Exploitation

Commande pour exploiter :
```bash
./bin $(python -c "print 'A'*64 + '\x64\x63\x62\x61'")
```

### Explication

- Le buffer a une taille de 64 octets.
- La variable cible est un entier de 4 octets juste après le buffer.
- '\x64\x63\x62\x61' représente "dcba" en little-endian (0x61626364 en hexadécimal).
- En remplissant le buffer puis en écrasant la variable cible, on déclenche la condition de succès.

### Processus d'exploitation

- Identification de la taille du buffer par essais successifs.
- Compréhension de l'ordre des octets (little-endian) dans la cible.
- Construction précise du payload pour écraser la variable cible.

### Leçons de sécurité

- Ne jamais utiliser strcpy() sans vérification de la longueur.
- Toujours valider les entrées utilisateur, y compris les arguments en ligne de commande.
- Être conscient de l'endianness du système lors de la manipulation de données binaires.

### Outils utilisés

- objdump pour le désassemblage
- Python pour générer le payload


### Version hypothétique du code source en Go:

```go
package main

import (
    "fmt"
    "os"
    "unsafe"
)

func main() {
    if len(os.Args) != 2 {
        fmt.Println("bin: please specify an argument")
        os.Exit(1)
    }

    var buffer [64]byte  // Buffer de 64 octets
    var target uint32 = 0  // Variable cible, initialisée à 0

    // Copie l'argument dans le buffer sans vérification de taille
    // C'est ici que se trouve la vulnérabilité
    copy(buffer[:], os.Args[1])

    // Vérifie si la variable target a été modifiée à la valeur souhaitée
    if target == 0x61626364 {  // 'dcba' en little-endian
        fmt.Println("Good job, you win!")
    } else {
        fmt.Printf("Try again, you got 0x%08x\n", target)
    }
}
```