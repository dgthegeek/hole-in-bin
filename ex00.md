# Binary Exploitation Challenges

## Ex00: Buffer Overflow Basics

### Disassembly Analysis

Utilisé `objdump -d bin > disassembled.txt` pour désassembler le binaire.

Points clés du code assembleur :

```assembly
080483f4 <main>:
 80483fa:	83 ec 60             	sub    $0x60,%esp
 804840c:	e8 fb fe ff ff       	call   804830c <gets@plt>
 8048411:	8b 44 24 5c          	mov    0x5c(%esp),%eax
 8048415:	85 c0                	test   %eax,%eax
 8048417:	74 0e                	je     8048427 <main+0x33>
 8048419:	c7 04 24 00 85 04 08 	movl   $0x8048500,(%esp)
 8048420:	e8 07 ff ff ff       	call   804832c <puts@plt>
```

### Analyse :

Le programme alloue 0x60 (96) octets sur la pile.
Utilise la fonction vulnérable gets() pour lire l'entrée utilisateur.
Vérifie une valeur à 0x5c(%esp) (92 octets après le début du buffer).
Si cette valeur est non nulle, affiche le message de succès.

### Vulnérabilité
Le programme utilise gets(), qui ne vérifie pas la longueur de l'entrée, permettant un débordement de tampon (buffer overflow).

### Exploitation
Commande pour exploiter :
```bash
python -c "print 'A'*79" | ./bin
```
Cette commande écrit 79 'A' dans le buffer, écrasant juste assez pour modifier la variable cible sans causer de segmentation fault.

### Explication

Le buffer alloué est de 96 octets.
La variable 'modified' est stockée à 92 octets du début du buffer.
En écrivant 79 'A', on remplit le buffer et on écrase partiellement la variable 'modified', la rendant non nulle.
Cela déclenche la condition pour afficher le message de succès.

### Leçons de sécurité

- Ne jamais utiliser gets() - c'est une fonction dangereuse et déconseillée.
- Toujours valider et limiter la longueur des entrées utilisateur.
- Utiliser des fonctions sécurisées comme fgets() qui permettent de spécifier une longueur maximale.
- Compiler avec des protections comme stack canaries et ASLR pour rendre l'exploitation plus difficile.

### Outils utilisés

- objdump : Pour désassembler le binaire.
- Python : Pour générer une chaîne d'entrée précise.

### Approche et réflexion

- Analyse statique du binaire désassemblé pour comprendre sa structure.
- Identification de la vulnérabilité (utilisation de gets()).
- Expérimentation avec différentes longueurs d'entrée pour trouver le point exact où la variable est modifiée.
- Affinement de l'exploit pour éviter le segmentation fault tout en déclenchant le message de succès.

Cette approche méthodique permet de comprendre et d'exploiter efficacement la vulnérabilité sans recourir à des scripts externes ou à des décompilateurs.